# Support for QuodLibet music player
# Written by: Maciej Delmanowski <harnir@post.pl>
# sed commands by: Grzegorz Niewï¿½owski <hoppke@dobremiasto.net>

# Overview:
# This is a set of function for controlling the Music Player Daemon
# (http://www.musicpd.org/). It is done using the 'mpc' command-line frontend.


# If there is no selected mixer, load the default
CheckPreferences DefaultMixer "Include components/functions/Mixer-quodlibet"

# ---------------------------------------------------------------------------
# Main menu
DestroyMenu /Music
AddToMenu /Music
+ DynamicPopupAction Function /Music-generator

DestroyFunc /Music-generator
AddToFunc /Music-generator
+ I DestroyMenu recreate /Music
+ I PipeRead 'quodlibet --print-playing | sed -e "s:^.*$:AddToMenu /Music \'&\' :"'
+ I AddToMenu /Music "" Nop
+ I AddToMenu /Music '$[gt.Volume]' Popup /Mixer
+ I AddToMenu /Music '$[gt.Toggle random]' Music-ToggleRandom
+ I AddToMenu /Music '$[gt.Toggle repeat]' Exec quodlibet --repeat t
+ I AddToMenu /Music "" Nop
+ I AddToMenu /Music '$[gt.Play/Pause]'		Music-PlayPause

# ---------------------------------------------------------------------------
# Basic control functions
DestroyFunc Music-Play
AddToFunc Music-Play
+ I Exec quodlibet --play > /dev/null

DestroyFunc Music-Pause
AddToFunc Music-Pause
+ I Exec quodlibet --pause > /dev/null

DestroyFunc Music-Stop
AddToFunc Music-Stop
+ I Exec quodlibet --pause > /dev/null

DestroyFunc Music-PlayPause
AddToFunc Music-PlayPause
+ I Exec quodlibet --play-pause > /dev/null

DestroyFunc Music-Next
AddToFunc Music-Next
+ I Exec quodlibet --next > /dev/null

DestroyFunc Music-Prev
AddToFunc Music-Prev
+ I Exec quodlibet --previous > /dev/null

DestroyFunc Music-Forward
AddToFunc Music-Forward
+ I Exec quodlibet --shuffle t > /dev/null; quodlibet --next > /dev/null; quodlibet --shuffle t > /dev/null

DestroyFunc Music-Backward
AddToFunc Music-Backward
+ I Exec quodlibet --shuffle t > /dev/null; quodlibet --previous > /dev/null; quodlibet --shuffle t > /dev/null

DestroyFunc Music-ToggleRandom
AddToFunc Music-ToggleRandom
+ I Exec quodlibet --shuffle t

DestroyFunc Music-GUI
AddToFunc Music-GUI
+ I Nop

DestroyFunc Music-Find
AddToFunc Music-Find
+ I Nop

# vim:ft=fvwm
